<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InvestWise Predictor | AI-Powered Investment Blueprints</title>
    <link rel="icon" href="assets/logo.svg" type="image/svg+xml">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Lottie Player -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    
    <!-- Heroicons for SVGs -->
    <script type="module" src="https://unpkg.com/heroicons@2.1.1/24/outline/index.js"></script>


    <!-- Custom Styles & Tailwind Configuration -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* A slightly off-white bg */
        }
        /* Custom class for scroll-in animations */
        .fade-in-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s cubic-bezier(0.6, 0.01, 0.35, 1), transform 0.8s cubic-bezier(0.6, 0.01, 0.35, 1);
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Chat bubble styles */
        .chat-bubble {
            max-width: 80%;
            padding: 12px 18px;
            border-radius: 20px;
            word-wrap: break-word;
            line-height: 1.6;
        }
        .user-bubble {
            background-color: #1E3A8A; /* brand-blue */
            color: white;
            border-bottom-right-radius: 5px;
            align-self: flex-end;
        }
        .ai-bubble {
            background-color: #e5e7eb; /* gray-200 */
            color: #111827; /* brand-dark */
            border-bottom-left-radius: 5px;
            align-self: flex-start;
        }
        .ai-bubble strong {
            color: #1E3A8A;
        }
        .ai-bubble ul {
            list-style-type: disc;
            padding-left: 20px;
            margin-top: 8px;
        }
        /* Typing indicator */
        .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: #9ca3af;
            display: inline-block;
            border-radius: 50%;
            animation: bounce 1.3s infinite;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-blue': '#1E3A8A',
                        'brand-green': '#059669',
                        'brand-light': '#F0F9FF',
                        'brand-dark': '#111827',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header & Navigation Bar -->
    <header id="header" class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <!-- Logo -->
            <a href="index.html" class="flex items-center space-x-2">
                <img src="assets/logo.svg" alt="InvestWise Logo" class="h-8 w-8">
                <span class="text-2xl font-bold text-brand-blue">InvestWise</span>
            </a>
            
            <!-- Desktop Menu -->
            <div class="hidden lg:flex items-center space-x-7">
                <a href="index.html" class="text-gray-700 font-medium hover:text-brand-blue transition-colors duration-300">Home</a>
                <a href="features.html" class="text-gray-700 font-medium hover:text-brand-blue transition-colors duration-300">Features</a>
                <a href="dashboard.html" class="text-gray-700 font-medium hover:text-brand-blue transition-colors duration-300">Dashboard</a>
                <a href="how-it-works.html" class="text-gray-700 font-medium hover:text-brand-blue transition-colors duration-300">How It Works</a>
                <a href="about.html" class="text-gray-700 font-medium hover:text-brand-blue transition-colors duration-300">About</a>
                <a href="contact.html" class="text-gray-700 font-medium hover:text-brand-blue transition-colors duration-300">Contact</a>
            </div>

            <!-- CTA Button -->
            <a href="waitlist.html" class="hidden lg:block bg-brand-green hover:bg-green-700 text-white font-bold py-2.5 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 hover:shadow-lg">
                Join Waitlist
            </a>

            <!-- Mobile Menu Button -->
            <button id="mobile-menu-button" class="lg:hidden text-brand-dark focus:outline-none">
                <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </nav>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden lg:hidden px-6 pb-4">
            <a href="index.html" class="block py-2 text-gray-700 font-medium hover:text-brand-blue">Home</a>
            <a href="features.html" class="block py-2 text-gray-700 font-medium hover:text-brand-blue">Features</a>
            <a href="dashboard.html" class="block py-2 text-gray-700 font-medium hover:text-brand-blue">Dashboard Preview</a>
            <a href="how-it-works.html" class="block py-2 text-gray-700 font-medium hover:text-brand-blue">How It Works</a>
            <a href="about.html" class="block py-2 text-gray-700 font-medium hover:text-brand-blue">About Us</a>
            <a href="contact.html" class="block py-2 text-gray-700 font-medium hover:text-brand-blue">Contact</a>
            <a href="waitlist.html" class="block mt-4 w-full text-center bg-brand-green hover:bg-green-700 text-white font-bold py-2 px-5 rounded-lg shadow-md">
                Join Waitlist
            </a>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="relative bg-white overflow-hidden">
            <div class="container mx-auto px-6 py-20 md:py-24">
                <div class="grid md:grid-cols-2 gap-12 items-center">
                    <div class="z-10 text-center md:text-left">
                        <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold text-brand-dark leading-tight mb-4">
                            Your Investment Blueprint, <span class="text-brand-blue">Powered by AI.</span>
                        </h1>
                        <p class="max-w-xl mx-auto md:mx-0 text-lg md:text-xl text-gray-600 mb-8">
                            Stop guessing. Start building. InvestWise Predictor translates complex Kenyan market data into clear, actionable strategies, helping you turn ambition into assets.
                        </p>
                        <div class="flex flex-col sm:flex-row justify-center md:justify-start space-y-4 sm:space-y-0 sm:space-x-4">
                            <a href="#ai-chatbot-section" class="bg-brand-blue hover:bg-blue-800 text-white font-bold py-3 px-8 rounded-lg shadow-xl transition-all duration-300 transform hover:scale-105 text-lg">
                                Ask Our AI Analyst
                            </a>
                            <a href="how-it-works.html" class="bg-gray-200 hover:bg-gray-300 text-brand-dark font-bold py-3 px-8 rounded-lg shadow-xl transition-all duration-300 transform hover:scale-105 text-lg">
                                How It Works
                            </a>
                        </div>
                    </div>
                    <div class="relative flex justify-center items-center">
                         <lottie-player src="https://assets4.lottiefiles.com/packages/lf20_o18s24so.json" background="transparent" speed="1" style="width: 100%; max-width: 500px; height: auto;" loop autoplay></lottie-player>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Chatbot Section -->
        <section id="ai-chatbot-section" class="py-20 bg-white fade-in-section">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-brand-dark">Ask Our AI Investment Analyst</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">Have a question? Pose it to our AI. Get an instant, detailed analysis based on our predictive models. Try asking: "What's the outlook for greenhouse farming in Kiambu county?"</p>
                </div>

                <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl border border-gray-200">
                    <div id="chat-window" class="h-[32rem] p-6 overflow-y-auto flex flex-col space-y-4">
                        <!-- Initial AI message -->
                        <div class="chat-bubble ai-bubble">
                            Hello! I am the InvestWise AI Analyst. How can I help you explore investment opportunities in Kenya today?
                        </div>
                    </div>
                    <div class="p-4 border-t border-gray-200 bg-gray-50 rounded-b-2xl">
                        <div class="flex items-center space-x-3">
                            <input type="text" id="chat-input" placeholder="e.g., Analyze real estate in Ruai..." class="flex-grow w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-blue transition-shadow">
                            <button id="chat-send-button" class="bg-brand-green hover:bg-green-700 text-white font-bold p-3 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 14l11 -11"></path><path d="M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5"></path></svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Market Opportunities Section -->
        <section class="py-20 bg-brand-light fade-in-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold text-brand-dark">Explore Market Opportunities</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Discover high-potential sectors across Kenya, identified by our AI and validated by local data.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Opportunity 1: Agriculture -->
                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="flex items-center space-x-4 mb-4">
                             <div class="bg-green-100 text-brand-green p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 18-6-6"></path><path d="m22 22-6-6"></path><path d="M13 3 3 13"></path><path d="M16 16c-2.5 2.5-5.5 4-9 4"></path><path d="M8 8c2.5-2.5 5.5-4 9-4"></path></svg></div>
                            <h3 class="text-2xl font-bold">Agriculture</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Focus on drought-resistant crops like sorghum and macadamia in arid/semi-arid lands (ASALs). Our data shows a 25% increase in demand for climate-resilient value chains.</p>
                        <a href="features.html#agri" class="font-bold text-brand-blue hover:underline">Learn More &rarr;</a>
                    </div>
                    <!-- Opportunity 2: Real Estate -->
                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="flex items-center space-x-4 mb-4">
                            <div class="bg-blue-100 text-brand-blue p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21v-8a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2z"></path><path d="M8 21v-8a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2z"></path><path d="M12 3v5"></path><path d="M9 21v-5a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3v5"></path></svg></div>
                            <h3 class="text-2xl font-bold">Real Estate</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Satellite towns around Nairobi (e.g., Ruai, Juja) are booming. Invest in affordable student housing and low-cost family units, where demand outstrips supply by 3:1.</p>
                        <a href="features.html#real-estate" class="font-bold text-brand-blue hover:underline">Learn More &rarr;</a>
                    </div>
                    <!-- Opportunity 3: Tech & Startups -->
                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="flex items-center space-x-4 mb-4">
                            <div class="bg-purple-100 text-purple-600 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7 11 5 5 5-5"></path><path d="m7 5 5 5 5-5"></path></svg></div>
                            <h3 class="text-2xl font-bold">Fintech</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Targeted credit products for SMEs in informal settlements like Kayole and Umoja. Digital payment adoption is at 85%, but access to credit remains below 20%.</p>
                        <a href="features.html#tech" class="font-bold text-brand-blue hover:underline">Learn More &rarr;</a>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Technology Stack Section -->
        <section class="py-20 bg-white fade-in-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold text-brand-dark">Built with Powerful Technology</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Our platform leverages a modern, scalable technology stack to deliver robust predictions and a seamless user experience.</p>
                </div>
                <div class="max-w-5xl mx-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8 text-center">
                    <div class="flex flex-col items-center">
                        <img src="https://placehold.co/80x80/EBF8FF/1E3A8A?text=React" class="h-20 w-20 rounded-full bg-gray-200 mb-3" alt="React Logo">
                        <h4 class="font-bold text-lg">React</h4>
                        <p class="text-sm text-gray-500">Frontend</p>
                    </div>
                     <div class="flex flex-col items-center">
                        <img src="https://placehold.co/80x80/EBF8FF/1E3A8A?text=Django" class="h-20 w-20 rounded-full bg-gray-200 mb-3" alt="Django Logo">
                        <h4 class="font-bold text-lg">Django</h4>
                        <p class="text-sm text-gray-500">Backend</p>
                    </div>
                     <div class="flex flex-col items-center">
                        <img src="https://placehold.co/80x80/EBF8FF/1E3A8A?text=TensorFlow" class="h-20 w-20 rounded-full bg-gray-200 mb-3" alt="TensorFlow Logo">
                        <h4 class="font-bold text-lg">TensorFlow</h4>
                        <p class="text-sm text-gray-500">ML Engine</p>
                    </div>
                     <div class="flex flex-col items-center">
                        <img src="https://placehold.co/80x80/EBF8FF/1E3A8A?text=PostgreSQL" class="h-20 w-20 rounded-full bg-gray-200 mb-3" alt="PostgreSQL Logo">
                        <h4 class="font-bold text-lg">PostgreSQL</h4>
                        <p class="text-sm text-gray-500">Database</p>
                    </div>
                     <div class="flex flex-col items-center">
                        <img src="https://placehold.co/80x80/EBF8FF/1E3A8A?text=Docker" class="h-20 w-20 rounded-full bg-gray-200 mb-3" alt="Docker Logo">
                        <h4 class="font-bold text-lg">Docker</h4>
                        <p class="text-sm text-gray-500">DevOps</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Founder Profile Section -->
        <section class="bg-brand-dark text-white py-20 fade-in-section">
            <div class="container mx-auto px-6">
                <div class="md:flex md:items-center md:space-x-12">
                    <div class="md:w-1/3 mb-8 md:mb-0 text-center flex-shrink-0">
                        <img src="assets/daniel-wanjala.jpg" 
                             alt="Daniel Wanjala, Founder of InvestWise Predictor" 
                             class="rounded-full w-48 h-48 md:w-64 md:h-64 object-cover mx-auto shadow-2xl border-4 border-brand-green"
                             onerror="this.onerror=null;this.src='https://placehold.co/300x300/F0F9FF/111827?text=Daniel+Wanjala';">
                    </div>
                    <div class="md:w-2/3">
                        <h2 class="text-3xl md:text-4xl font-bold mb-4">The Mind Behind the Mission</h2>
                        <h3 class="text-2xl font-semibold text-green-400 mb-4">Daniel Wanjala, Founder & CEO</h3>
                        <p class="text-lg text-gray-300 mb-6">
                            Daniel Wanjala is a Kenyan data scientist with a passion for democratizing economic intelligence. Holding a Master’s in Data Science from the University of Nairobi and having honed his skills at Moringa School, Daniel saw a critical gap: data was everywhere, but actionable guidance was scarce.
                        </p>
                        <blockquote class="border-l-4 border-brand-green pl-6 italic text-gray-200 text-xl">
                            "InvestWise was born from a simple vision: to turn economic complexity into business clarity for every Kenyan with a dream. We're building a more equitable future, where your capital works for you, guided by data, not guesswork."
                        </blockquote>
                    </div>
                </div>
            </div>
        </section>

        <!-- Final CTA Section -->
        <section class="bg-gray-100 fade-in-section">
            <div class="container mx-auto px-6 py-20 text-center">
                <h2 class="text-3xl md:text-4xl font-bold text-brand-dark mb-4">Ready to Build Your Future?</h2>
                <p class="max-w-2xl mx-auto text-lg text-gray-600 mb-8">
                    Your next great investment is waiting to be discovered. Join our waitlist to be first in line for access to InvestWise Predictor, and receive exclusive market insights directly to your inbox. The future is predictable.
                </p>
                <a href="waitlist.html" class="bg-brand-green hover:bg-green-600 text-white font-bold py-4 px-10 rounded-lg shadow-2xl transition-all duration-300 transform hover:scale-105 inline-block text-lg">
                    Secure Your Spot
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-brand-dark text-gray-400">
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-8">
                <!-- About Column -->
                <div class="col-span-2 lg:col-span-2">
                    <a href="index.html" class="flex items-center space-x-2 mb-4">
                        <img src="assets/logo.svg" alt="InvestWise Logo" class="h-8 w-8 filter invert">
                        <span class="text-2xl font-bold text-white">InvestWise</span>
                    </a>
                    <p class="pr-8">Empowering Kenya's investors with AI-driven insights. From Nairobi to Namanga—invest smarter, predict better.</p>
                </div>
                <!-- Links Column -->
                <div>
                    <h4 class="font-semibold text-white mb-4">Explore</h4>
                    <ul>
                        <li class="mb-2"><a href="features.html" class="hover:text-white">Features</a></li>
                        <li class="mb-2"><a href="how-it-works.html" class="hover:text-white">How It Works</a></li>
                        <li class="mb-2"><a href="about.html" class="hover:text-white">About Us</a></li>
                        <li class="mb-2"><a href="blog.html" class="hover:text-white">Blog</a></li>
                    </ul>
                </div>
                <!-- Support Column -->
                <div>
                    <h4 class="font-semibold text-white mb-4">Support</h4>
                     <ul>
                        <li class="mb-2"><a href="faqs.html" class="hover:text-white">FAQs</a></li>
                        <li class="mb-2"><a href="contact.html" class="hover:text-white">Contact Us</a></li>
                        <li class="mb-2"><a href="#" class="hover:text-white">Privacy Policy</a></li>
                    </ul>
                </div>
                 <!-- Social Media Column -->
                <div>
                    <h4 class="font-semibold text-white mb-4">Connect</h4>
                    <div class="flex space-x-4">
                        <a href="#" aria-label="Twitter" class="hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.71v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></a>
                        <a href="#" aria-label="LinkedIn" class="hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg></a>
                    </div>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-700 pt-8 text-center text-sm">
                <p>&copy; <span id="current-year"></span> InvestWise Predictor. All Rights Reserved. A Prototype by Daniel Wanjala.</p>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById('mobile-menu-button').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        const sections = document.querySelectorAll('.fade-in-section');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });
        sections.forEach(section => observer.observe(section));

        document.getElementById('current-year').textContent = new Date().getFullYear();

        const chatWindow = document.getElementById('chat-window');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('chat-send-button');
        const apiKey = 'AIzaSyCOyiZkk8t7zFtX4zC9G4v66MPJfgjIi84';

        const handleChatSubmit = () => {
            const userQuery = chatInput.value.trim();
            if (!userQuery) return;

            appendMessage(userQuery, 'user');
            chatInput.value = '';
            
            const typingIndicator = showTypingIndicator();

            generateAIResponse(userQuery).then(aiResponse => {
                hideTypingIndicator(typingIndicator);
                appendMessage(aiResponse, 'ai', true);
            });
        };

        sendButton.addEventListener('click', handleChatSubmit);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                handleChatSubmit();
            }
        });

        function appendMessage(text, sender, useTypewriter = false) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('chat-bubble', sender === 'user' ? 'user-bubble' : 'ai-bubble');

            if (useTypewriter) {
                let i = 0;
                const speed = 5; 
                function type() {
                    if (i < text.length) {
                        messageElement.innerHTML = text.substring(0, i + 1).replace(/\n/g, '<br>');
                        i++;
                        chatWindow.scrollTop = chatWindow.scrollHeight;
                        setTimeout(type, speed);
                    }
                }
                type();
            } else {
                 messageElement.textContent = text;
            }
            
            chatWindow.appendChild(messageElement);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.classList.add('chat-bubble', 'ai-bubble', 'typing-indicator');
            typingDiv.innerHTML = '<span></span><span></span><span></span>';
            chatWindow.appendChild(typingDiv);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            return typingDiv;
        }

        function hideTypingIndicator(indicator) {
            if (indicator && indicator.parentNode === chatWindow) {
                chatWindow.removeChild(indicator);
            }
        }

        async function generateAIResponse(query) {
            console.log("Attempting live API call to Gemini with query:", query);
            
            const payload = {
                contents: [{ role: "user", parts: [{ text: query }] }]
            };
            
            // This is now an active API call. It will likely fail due to the fake API key,
            // but the catch block will handle the error gracefully.
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    // Handle HTTP errors like 4xx, 5xx
                    const errorData = await response.json();
                    console.error("API Error Response:", errorData);
                    throw new Error(`API returned status ${response.status}. Please check the API key and request format.`);
                }

                const result = await response.json();
                const text = result.candidates[0].content.parts[0].text;
                return text;

            } catch (error) {
                console.error("API call failed:", error);
                // The API call will fail, so we return a detailed mock response instead.
                // This simulates the desired behavior for the prototype.
                await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate network delay
                
                if (query.toLowerCase().includes("greenhouse farming in kiambu")) {
                    return `**Comprehensive Analysis: Greenhouse Farming in Kiambu County**

Based on our multi-factor analysis, greenhouse farming in Kiambu County presents a strong investment opportunity with a projected high ROI, contingent on strategic crop selection and market positioning. Here is a detailed breakdown:

**1. Market & Demand Analysis:**
Kiambu's proximity to Nairobi provides a significant advantage. The urban market has a consistent and growing demand for high-value, fresh produce such as tomatoes, capsicums (bell peppers), cucumbers, and herbs. Our data shows a 12% year-over-year increase in demand for organically grown and specialty vegetables from Nairobi's hospitality sector and middle-to-upper-income households.
* **Recommendation:** Focus on high-value crops. Cherry tomatoes, colored capsicums, and fresh herbs (like basil and rosemary) offer higher profit margins compared to traditional cabbage or kale.

**2. Climate & Environmental Factors:**
Kiambu's climate is highly favorable, with moderate temperatures and reliable rainfall patterns. However, our climate models project a 5% increase in temperature variability over the next decade.
* **Advantage:** Greenhouses mitigate climate risks, ensuring year-round production and protecting crops from unpredictable weather and pests. This allows for consistent supply to the market, commanding premium prices, especially during off-seasons.
* **Water Management:** Access to water is critical. We recommend investing in a water harvesting system (rooftop collection from the greenhouse) and drip irrigation. Drip irrigation can reduce water consumption by up to 70% and increase yield by 20-50%.

**3. Economic & ROI Projections:**
* **Initial Capital Outlay:** A standard 8x15 meter metallic greenhouse, including installation and a basic drip irrigation system, costs approximately KES 200,000 - 350,000.
* **Operational Costs:** Key costs include seeds/seedlings, fertilizers, pest control, labor, and water.
* **Projected Revenue (Example: Tomatoes):** A single greenhouse can house around 600 tomato plants. With good management, each plant can yield 8-15 kgs. At a conservative yield of 10 kgs/plant and a market price of KES 80/kg, the potential revenue per cycle (6-8 months) is: 600 plants * 10 kg/plant * 80 KES/kg = KES 480,000.
* **Projected ROI:** After deducting operational costs (approx. KES 100,000 - 150,000), the net profit can be substantial. The initial investment can often be recouped within the first two production cycles, leading to an ROI of over 100% within 18 months.

**4. Risks & Mitigation Strategies:**
* **Pest and Disease:** Whiteflies and blight are common. An integrated pest management (IPM) strategy is essential.
* **Market Fluctuations:** Prices can be volatile. Secure contracts with hotels, restaurants, or exporters to guarantee stable pricing.
* **Technical Knowledge:** Proper greenhouse management is crucial. We recommend attending training workshops or hiring an experienced farm manager for the initial phase.

In conclusion, Kiambu offers a fertile ground for greenhouse farming. Success hinges on moving beyond basic production to a market-led approach focusing on high-value crops, efficient water management, and securing stable offtake agreements. Our platform can provide further granular data on specific sub-county performance and connect you with certified input suppliers.`;
                } else if (query.toLowerCase().includes("real estate") && query.toLowerCase().includes("ruai")) {
                    return `**In-Depth Analysis: Real Estate Investment in Ruai**

Ruai represents a significant growth corridor for real estate investment, primarily driven by infrastructure development and population spillover from Nairobi's core. Our analysis identifies the following key points:

**1. Primary Drivers:**
* **Infrastructure:** The expansion of Kangundo Road and the proposed Eastern Bypass link have significantly reduced commute times, making Ruai more attractive to middle-income families.
* **Affordability:** Land and property prices are, on average, 40-50% lower than in more established satellite towns like Kitengela or Rongai, providing a lower barrier to entry for investors.
* **Demographics:** The area is attracting a young demographic (25-40 years old) of first-time homeowners and renters, creating strong demand for affordable housing.

**2. Top Investment Opportunities:**
* **Gated Communities:** There is high demand for secure, gated communities offering standalone bungalows and maisonettes. Our models predict a 15-20% annual appreciation rate for such properties over the next 5 years.
* **High-Density Rental Units:** Develop blocks of one and two-bedroom apartments targeting the rental market. Current occupancy rates are above 90%, with rental yields averaging 6-8% annually.
* **Commercial Plots:** Acquire plots along the main tarmac roads for future commercial development (e.g., small shopping centers, hardware stores, private schools) to serve the growing population.

**3. Risk Factors:**
* **Zoning & Regulation:** Land use regulations are still evolving. Conduct thorough due diligence to ensure plots are properly zoned for your intended development.
* **Utility Infrastructure:** While improving, access to reliable water and sewerage can be a challenge in some parts of Ruai. Factor in the cost of boreholes or biodigesters.
* **Market Saturation:** As the area develops, the risk of oversupply in specific segments (e.g., bedsitters) could increase. Focus on quality and differentiated amenities to stand out.

**Conclusion:** Ruai is a high-potential area for investors with a medium to long-term horizon. The most promising strategy is to focus on affordable, quality housing within organized, secure developments.`;
                } else {
                    return `I'm sorry, my connection to the live analysis server seems to be unstable. However, I can still provide insights based on my latest cached data.

For the best results, please ask a specific question about a sector and a location. For example:
- "Analyze the potential for aquaculture in Lake Victoria."
- "What are the trends for B2B logistics startups in Mombasa?"
- "Compare macadamia farming in Embu versus Meru."`;
                }
            }
        }
    </script>
</body>
</html>
